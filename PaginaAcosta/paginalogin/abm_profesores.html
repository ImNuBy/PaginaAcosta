<h2>Gesti√≥n de Profesores</h2>

<form id="formProfesor">
  <input type="hidden" name="id" id="id">
  <input type="text" name="nombre" id="nombre" placeholder="Nombre del profesor" required>
  <input type="text" name="materia" id="materia" placeholder="Materia" required>
  <input type="text" name="horario" id="horario" placeholder="Horario (Ej: Lun 10-12)" required>
  <button type="submit">Guardar</button>
</form>

<table border="1" style="margin-top: 20px;">
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Materia</th>
      <th>Horario</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody id="tablaProfesores">
    <!-- Se llena con JS -->
  </tbody>
</table>

<script>
  const formProfesor = document.getElementById('formProfesor');
  const tablaProfesores = document.getElementById('tablaProfesores');

  function cargarProfesores() {
    fetch('php/obtener_profesores.php')
      .then(res => res.json())
      .then(data => {
        tablaProfesores.innerHTML = '';
        data.forEach(p => {
          tablaProfesores.innerHTML += `
            <tr>
              <td>${p.nombre}</td>
              <td>${p.materia}</td>
              <td>${p.horario}</td>
              <td>
                <button onclick="editarProfesor(${p.id}, '${p.nombre}', '${p.materia}', '${p.horario}')">‚úèÔ∏è</button>
                <button onclick="eliminarProfesor(${p.id})">üóëÔ∏è</button>
              </td>
            </tr>
          `;
        });
      });
  }

  formProfesor.addEventListener('submit', function(e) {
    e.preventDefault();
    const datos = new FormData(formProfesor);
    fetch('php/guardar_profesor.php', {
      method: 'POST',
      body: datos
    })
    .then(res => res.text())
    .then(res => {
      if (res === "ok") {
        alert("Guardado correctamente");
        formProfesor.reset();
        cargarProfesores();
      } else {
        alert("Error al guardar");
      }
    });
  });

  function editarProfesor(id, nombre, materia, horario) {
    document.getElementById('id').value = id;
    document.getElementById('nombre').value = nombre;
    document.getElementById('materia').value = materia;
    document.getElementById('horario').value = horario;
  }

  function eliminarProfesor(id) {
    if (confirm("¬øEliminar profesor?")) {
      fetch(`php/eliminar_profesor.php?id=${id}`)
        .then(res => res.text())
        .then(res => {
          if (res === "ok") {
            cargarProfesores();
          } else {
            alert("Error al eliminar");
          }
        });
    }
  }

  cargarProfesores();
</script>
